- name: "启动api service服务"
  hosts: api
  tasks:
    - name: "使用Docker Compose启动api service服务"
      shell: |
        set -e
        cd ~/deployer-spring-boot-benchmark/service
        docker compose pull && docker compose up -d
- name: "启动api service2服务"
  hosts: api
  tasks:
    - name: "使用Docker Compose启动api service2服务"
      shell: |
        set -e
        cd ~/deployer-spring-boot-benchmark/service2
        docker compose pull && docker compose up -d
      when: server_port2 is defined

- name: "启动prometheus公共服务"
  hosts: common
  tasks:
    - name: "使用Docker Compose启动prometheus公共服务"
      shell: |
        set -e
        cd ~/deployer-spring-boot-benchmark/prometheus
        docker compose pull && docker compose up -d

- name: "启动OpenResty服务"
  hosts: openresty
  tasks:
    - name: "使用Docker Compose启动OpenResty服务"
      shell: |
        set -e
        cd ~/deployer-spring-boot-benchmark/openresty
        docker compose pull && docker compose up -d

- name: "启动node_exporter"
  hosts: "{{ groups['all'] | difference(groups['management']) }}"
  tasks:
    - name: "使用Docker Compose启动node_exporter"
      shell: |
        set -e
        cd ~/deployer-spring-boot-benchmark/node-exporter
        docker compose up -d
