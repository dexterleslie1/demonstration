version: "3.0"

services:
  demo-spring-boot-dubbo-consumer:
    build:
      context: ./demo-spring-boot-dubbo-consumer
      dockerfile: Dockerfile
    environment:
      - JAVA_OPTS=-Xmx512m
      - TZ=Asia/Shanghai
    image: registry.cn-hangzhou.aliyuncs.com/future-public/demo-spring-boot-dubbo-consumer
  demo-spring-boot-dubbo-provider:
    build:
      context: ./demo-spring-boot-dubbo-provider
      dockerfile: Dockerfile
    environment:
      - JAVA_OPTS=-Xmx512m
      - TZ=Asia/Shanghai
    image: registry.cn-hangzhou.aliyuncs.com/future-public/demo-spring-boot-dubbo-provider

  demo-zookeeper:
    # image: zookeeper:3.4.9
    # image: zookeeper:3.8.4
    image: zookeeper:3.5.6
    environment:
      - TZ=Asia/Shanghai
      - JVMFLAGS=-Xmx512m -Xms512m -server
      # 禁用 zookeeper AdminServer
      # https://hub.docker.com/_/zookeeper
      - ZOO_ADMINSERVER_ENABLED=false
    network_mode: host
  demo-dubbo-admin:
    image: apache/dubbo-admin:0.6.0
    environment:
      - admin.registry.address=zookeeper://127.0.0.1:2181
      - admin.config-center=zookeeper://127.0.0.1:2181
      - admin.metadata-report.address=zookeeper://127.0.0.1:2181
      - server.port=8081
      - JAVA_OPTS=-Xmx512m
    depends_on:
      - demo-zookeeper
    network_mode: host
