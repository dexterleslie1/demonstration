version: "3.1"

services:
  service:
    image: registry.cn-hangzhou.aliyuncs.com/future-public/demo-flash-sale-service
    environment:
      - JAVA_OPTS=${java_opts}
      - TZ=Asia/Shanghai
      - common_db_host=${common_db_host}
      - common_db_port=${common_db_port}
      - common_redis_cluster_nodes=${common_redis_cluster_nodes}
      - common_rocketmq_namesrvhost=${common_rocketmq_namesrvhost}
      - kafka_bootstrap_servers=${kafka_bootstrap_servers}
      - common_zookeeper_host=${common_zookeeper_host}
      - common_cassandra_contact_points=${common_cassandra_contact_points}
      - SW_AGENT_NAME=${skywalking_agent_name}
      - SW_AGENT_INSTANCE_NAME=${skywalking_agent_instance_name}
      - SW_AGENT_COLLECTOR_BACKEND_SERVICES=${skywalking_agent_collector_backend_services}
      - SW_GRPC_LOG_SERVER_HOST=${skywalking_grpc_log_server_host}
      - random_id_picker_host=${random_id_picker_host}
      - random_id_picker_port=${random_id_picker_port}
      - future_count_host=${future_count_host}
      - future_count_port=${future_count_port}
      - sentinel_transport_dashboard=${sentinel_transport_dashboard}
      - sentinel_nacos_server_addr=${sentinel_nacos_server_addr}
    logging:
      driver: json-file
      options:
        max-size: "1g"
        max-file: "2"
    restart: unless-stopped
    network_mode: host
