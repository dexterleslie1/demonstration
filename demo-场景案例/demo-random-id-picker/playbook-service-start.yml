- name: "启动api服务"
  hosts: api
  tasks:
    - name: "使用Docker Compose启动api服务"
      shell: |
        set -e
        cd ~/deployer-demo-random-id-picker/service
        docker compose pull && docker compose up -d

- name: "启动zookeeper、redis等公共服务"
  hosts: common
  tasks:
    - name: "使用Docker Compose启动zookeeper、redis等公共服务"
      shell: |
        set -e
        cd ~/deployer-demo-random-id-picker/common
        docker compose pull && docker compose up -d

- name: "启动数据库服务"
  hosts: db
  tasks:
    - name: "使用Docker Compose启动数据库服务"
      shell: |
        # 命令执行错误马上退出 shell
        set -e
        cd ~/deployer-demo-random-id-picker/db
        # 拉取最新镜像并启动
        docker compose pull && docker compose up -d

- name: "启动OpenResty服务"
  hosts: openresty
  tasks:
    - name: "使用Docker Compose启动OpenResty服务"
      shell: |
        set -e
        cd ~/deployer-demo-random-id-picker/openresty
        docker compose pull && docker compose up -d     
